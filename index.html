<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="Keywords" content="" />
		<meta name="" content="" />
		<title>首页</title>
		<link rel="stylesheet" type="text/css" href="css/bin/swiper-3.3.1.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/bin/font-awesome-4.7.0/css/font-awesome.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/bin/mobilereset.css" />
		<link rel="stylesheet" type="text/css" href="css/page.css" />
		<script type="text/javascript" src="js/public.js"></script>
		<script type="text/javascript" src="js/bin/zepto.min.js" ></script>
		<!--<script src="https://cdn.bootcss.com/zepto/1.2.0/zepto.js"></script>-->
		<style type="text/css">
			.swiper-container-horizontal>.swiper-pagination-bullets{bottom: -0.05rem;}
			.swiper-pagination-bullet{ width: 0.25rem; height: 2px; display: inline-block;  border-radius: 0; }
		</style>
	</head>
	<body>
		<div class="E_index C_wrapper">
			<div class="header">
				<div class="index-MAORp">
					<div class="locational">
						<i class="_icon-local"></i>
						<span id="addressGeo">定位中......</span>
					</div>
					<aside class="clearfix">
						<div class="weater-text">
							<h2 id="temperature"></h2>
							<p id="weather"></p>
						</div>
						<img src="" alt="" id="weather_pic">
					</aside>
				</div>
				<div class="search"><input type="text" placeholder="搜索商家、商品"></div>
				<div class="index-Hot">
					<a href="#">棒冰</a>
					<a href="#">香锅</a>
					<a href="#">粉</a>
					<a href="#">0元魔爪</a>
					<a href="#">健身场</a>
					<a href="#">棒冰</a>
					<a href="#">老北京烤鸭</a>
				</div>
			</div>

			<div class="main">
				<div class="swiper-container banner">
					<div class="swiper-wrapper">
						<div class="swiper-slide swipe-item item1">
							<!--<a href="javascript:">
								<div class="container">
									<img src="//fuss10.elemecdn.com/b/7e/d1890cf73ae6f2adb97caa39de7fcjpeg.jpeg?imageMogr/format/webp/thumbnail/!90x90r/gravity/Center/crop/90x90/">
								</div>
								<span class="title">美食</span>
							</a>-->
						</div>
						<div class="swiper-slide swipe-item item2"></div>
				    </div>
				    <div class="swiper-pagination"></div>
				</div>    
				<h3 class="index-title">推荐商家</h3>
				<div class="wrap">
					<!--<div class="card">
						<div class="logo"><img src="//fuss10.elemecdn.com/0/da/66f918e98dad63ec74e812e3290d6png.png?imageMogr/format/webp/thumbnail/!120x120r/gravity/Center/crop/120x120/"/></div>
						<div class="content">
							<h3 class="shopname">永和大王（地铁东城张）</h3>
							<!-- 保，票等 icon 盒子-->
							<!--<div class="info-icon"></div>-->
							<!-- 评分，销量 -->
							<!--<section class="estimate">
								<i class="star"></i><span class="grade">4.6</span><span class="sale">月售<b class="saleCount">444</b>单</span>
							</section>-->
							<!--配送-->
							<!--<section class="carriage">
								<p><span>¥20起送</span><i>|</i><span>配送费¥4</span></p>
								<p><span class="distance">1.35km</span><i>|</i><span class="waitingTime">36分钟</span></p>
							</section>-->
							<!--活动框-->
							<!--<section class="activity">
								<p><i class="new">新</i><span>新用户下单立减少17.0元</span></p>
								<p><i class="subtract">减</i><span>满40减8</span></p>
							</section>-->
						<!--</div>
					</div>	-->
				</div>
			</div>

			<footer class="C_footer">
				<div class="home on" onclick="location.href='index.html'">
					<i class="fa fa-home fa-rocket"></i>
					<p>外卖</p>
				</div>
				<div class="shopcart" onclick="location.href='find.html'">
					<i class="fa fa-podcast fa-fw"></i>
					<p>发现</p>
				</div>
				<div class="myshow" onclick="location.href='order.html'">
					<i class="fa fa-file-o fa-fw"></i>
					<p>订单</p>
				</div>
				<div class="more" onclick="location.href='my.html'">
					<i class="fa fa-user-o fa-fw"></i>
					<p>我的</p>
			</footer>
		</div>
		<script type="text/javascript" src="js/bin/swiper-3.3.1.min.js"></script>
        <script type="text/javascript">
       		$.ajax({
       			type:"get",
       			url:"./data/ele-type.json",
       			async:true,
       			dataType:'json',
       			success:function(data){
//     				console.log(typeof data)
       				var $swiperWrapper = $('.swiper-wrapper')
       				var $swiperItem1 = $('.item1');
       				var $swiperItem2 = $('.item2');
       				$.each(data, function(index) {
       					if(index<8){
       						list($swiperItem1,index)
       					}else{
       						list($swiperItem2,index)
       					}
       					$swiperWrapper.append($swiperItem1);
       					$swiperWrapper.append($swiperItem2);
       					function list(ele,index){
       						var $thisBox = $('<a href="meishi.html"></a>');
	       					var $imgBox = $('<div class="container"></div>');
	       					var $thisImg = $('<img src="'+data[index].img_url+'"/>');
	       					var $title = $('<span class="title">'+data[index].name+'</span>');
	       					$thisImg.on('touchstart',function(){
       							alert(1)
       						})
	       					$imgBox.append($thisImg);
	       					$thisBox.append($imgBox);
	       					$thisBox.append($title);
	       					ele.append($thisBox);
	       					$swiperWrapper.append(ele)
       					}
       				});
       			}
       		});
       		
       		
       		$.ajax({
       			type:"get",
       			url:"./data/shops.json",
       			async:true,
       			dataType:'json',
       			success:function(data){	
//     				var data =JSON.parse(data+"")
//     				console.log(typeof data)
       				var $wrap = $('.wrap')
       				var card = '';
       				$.each(data, function(index) {
//     					console.log(data[index].img_url);
						var kfcUrl='window.location="kfc.html"';
       					 card += '<div class="card" onclick='+kfcUrl+'>'
									+'<div class="logo"><img src="'+data[index].img_url+'"/></div>'
									+'<div class="content">'
										+'<h3 class="shopname">'+data[index].name+'</h3>'
										+'<div class="info-icon"></div>'
										+'<section class="estimate">'
											+'<i class="star"></i><span class="grade">'+data[index].grade+'</span><span class="sale">月售<b class="saleCount">'+data[index].num+'</b>单</span>'
										+'</section>'
										+'<section class="carriage">'
										+'	<p><span>¥<i>'+data[index].start_pri+'</i>起送</span><i class="line">|</i><span>配送费¥<i>'+data[index].packing_fee+'</i></span></p>'
											+'<p><span class="distance">1.35km</span><i class="line">|</i><span class="waitingTime">36分钟</span></p>'
										+'</section>'
										+'<section class="activity">'
										+'	<p><i class="new">新</i><span>新用户下单立减少17.0元</span></p>'
											+'<p><i class="subtract">减</i><span>满40减8</span></p>'
										+'</section>'
									+'</div>'
								+'</div>'
       				});
       				 $wrap.append(card);
       			}
       		});
	
       		
			//Swiper初始化
			initSwiper()
			function initSwiper() {
				var swiper = new Swiper(".swiper-container", {
					loop:'true',
					pagination: ".swiper-pagination",
					paginationClickable: true
			//		paginationBulletRender:function(index,className){
			//			return '<span class="'+className+'">'+(index+1)+'</span>';
			//		},
				});
			}
       		
       		
       		// 扩展API加载完毕后调用onPlusReady回调函数 
			document.addEventListener('plusready', onPlusReady, false);
			// 扩展API加载完毕，现在可以正常调用扩展API
			function onPlusReady(){
				// 使用高德地图地位模块获取位置信息
				plus.geolocation.getCurrentPosition(function(p){
					$('#addressGeo').html('<i class="fa fa-map-marker" aria-hidden="true"> '+p.address.poiName);
//					getWeather(p.coords.latitude,p.coords.longitude );
				}, function(e){
					alert('Geolocation error: ' + e.message);
				},{provider:'amap'});
			}
			
			//获得天气接口
			function getWeather(lat,lng){
				$.ajax({
					type:"get",
					url:"http://ali-weather.showapi.com/gps-to-weather",
					async:true,
					beforeSend:function(request){
						request.setRequestHeader("Authorization","APPCODE "+"bd2d46dfbe6d49b881fb1a0dbf16af9e");
					},
					data:{'from':'3','lat':lat,'lng':lng},
					dataType:'json',
					success:function(data){
						$('#temperature').text(data.showapi_res_body.now.temperature+' ℃');
						$('#weather').text(data.showapi_res_body.now.weather);
						$('#weather_pic').attr('src',data.showapi_res_body.now.weather_pic);
					}
				});
			}

       	
       	
       	
       </script>
	</body>
</html>